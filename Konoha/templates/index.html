{% extends "base.html" %}
{% load static %}

{% block title %}Tienda PxG - Home{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
<link rel="stylesheet" href="{% static 'css/carrusel.css' %}">

{% endblock extra_css %}

{% block content %}
<main>
    <section class="banner-carousel">
        <div class="carousel-track">
            <img src="{% static 'imagenes/banner.png' %}" alt="Banner 1">
            <img src="{% static 'imagenes/imagen5.avif' %}" alt="Banner 2">
            <img src="{% static 'imagenes/imagen2.avif' %}" alt="Banner 3">
            <img src="{% static 'imagenes/imagen3.webp' %}" alt="Banner 4">
        </div>
        <button class="carousel-btn prev">⟨</button>
        <button class="carousel-btn next">⟩</button>
        <div class="carousel-indicators">
            <span class="active"></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </section>

    <section class="products-container">
        <div class="product-card">
            <img src="{% static 'imagenes/impresoras.png' %}" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$330</p>
            <button>+</button>
        </div>

        <div class="product-card">
            <img src="{% static 'imagenes/controles.png' %}" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$160</p>
            <button>+</button>
        </div>

        <div class="product-card">
            <img src="{% static 'imagenes/iPhone.jpg' %}" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$190</p>
            <button>+</button>
        </div>

        <div class="product-card">
            <img src="https://via.placeholder.com/150" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$120</p>
            <button>+</button>
        </div>
        
        <div class="product-card">
            <img src="https://via.placeholder.com/150" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$120</p>
            <button>+</button>
        </div>
        
        <div class="product-card">
            <img src="{% static 'imagenes/impresoras.png' %}" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$330</p>
            <button>+</button>
        </div>

        <div class="product-card">
            <img src="{% static 'imagenes/controles.png' %}" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$160</p>
            <button>+</button>
        </div>

        <div class="product-card">
            <img src="{% static 'imagenes/iPhone.jpg' %}" alt="Producto">
            <h3>Product name</h3>
            <p class="price">$190</p>
            <button>+</button>
        </div>
    </section> 

    <div class="pagination">
        <button>«</button>
        <button class="active">1</button>
        <button>2</button>
        <button>3</button>
        <button>»</button>
    </div>
</main>
{% endblock content %}

{% block extra_js %}
<script>
const track = document.querySelector('.carousel-track');
const slides = Array.from(track.children);
const prevBtn = document.querySelector('.carousel-btn.prev');
const nextBtn = document.querySelector('.carousel-btn.next');
const indicators = document.querySelectorAll('.carousel-indicators span');

let currentIndex = 0;

function updateCarousel() {
  if (slides.length === 0) return;
  // Usar clientWidth o getBoundingClientRect().width es más confiable que clientWidth para elementos ocultos/flex
  const width = slides[0].getBoundingClientRect().width; 
  track.style.transform = `translateX(-${currentIndex * width}px)`;
  indicators.forEach((dot, i) => {
    dot.classList.toggle('active', i === currentIndex);
  });
}

nextBtn.addEventListener('click', () => {
  currentIndex = (currentIndex + 1) % slides.length;
  updateCarousel();
});

prevBtn.addEventListener('click', () => {
  currentIndex = (currentIndex - 1 + slides.length) % slides.length;
  updateCarousel();
});

indicators.forEach((dot, i) => {
  dot.addEventListener('click', () => {
    currentIndex = i;
    updateCarousel();
  });
});

// autoplay cada 4 segundos
setInterval(() => {
  currentIndex = (currentIndex + 1) % slides.length;
  updateCarousel();
}, 4000);

// Asegurar la inicialización correcta
window.addEventListener('load', updateCarousel);
window.addEventListener('resize', updateCarousel);
</script>
{% endblock extra_js %}